{% extends 'base.html.twig' %}

{% block body %}
    <h1>Class List</h1>

    {# Mostrar mensajes flash si los hay (éxito o error) #}
    {% for label, messages in app.flashes %}
        {% for message in messages %}
            <div class="alert alert-{{ label }}">{{ message }}</div>
        {% endfor %}
    {% endfor %}

    <ul>
        {% for class in classes %}
            <li>
                <strong>{{ class.title }}</strong><br>
                {{ class.description }}<br>
                From: {{ class.startDate|date('Y-m-d H:i') }}<br>
                To: {{ class.endDate|date('Y-m-d H:i') }}<br>
                <small>Created by: {{ class.chef.username }}</small><br> {# Mostrar el nombre del chef #}

                {# Botones de editar y eliminar visibles solo para el chef que creó la clase #}
                {% if app.user and class.chef == app.user %}
                    <a href="{{ path('class_edit', { id: class.id }) }}" class="btn btn-secondary">Edit</a>
                    <form method="post" action="{{ path('class_delete', { id: class.id }) }}" style="display:inline;" onsubmit="return confirm('Are you sure you want to delete this class?');">
                        <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ class.id) }}">
                        <button class="btn btn-danger">Delete</button>
                    </form>
                {% endif %}
            </li>
        {% else %}
            <li>No classes available.</li>
        {% endfor %}
    </ul>

    {# Botón de crear clases, visible solo para chefs #}
    {% if app.user and is_granted('ROLE_CHEF') %}
        <a href="{{ path('class_new') }}" class="btn btn-primary mb-3">Create New Class</a>
    {% endif %}
{% endblock %}
